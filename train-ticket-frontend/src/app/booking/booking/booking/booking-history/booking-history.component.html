<!-- ğŸ” Filters -->
<div class="ticket-container" style="margin: 20px auto; text-align: center;">
  <label>
    ğŸ“… Year:
    <select [(ngModel)]="selectedYear" (change)="filterBookings()">
      <option value="">All</option>
      <option *ngFor="let y of years" [value]="y">{{ y }}</option>
    </select>
  </label>

  <label style="margin-left: 20px;">
    ğŸ—“ï¸ Month:
    <select [(ngModel)]="selectedMonth" (change)="filterBookings()">
      <option value="">All</option>
      <option *ngFor="let m of months" [value]="m.value">{{ m.name }}</option>
    </select>
  </label>
</div>

<!-- ğŸ”™ Back & Export -->
<div class="actions" style="margin-top: 20px; display: flex; justify-content: center;">
  <button routerLink="/train-search">â¬…ï¸ Back to Dashboard</button>
  <button (click)="downloadPDF()">ğŸ“„ Export as PDF</button>
</div>

<!-- ğŸ§¾ Booking History -->
<div id="bookingHistoryPDF" class="history-wrapper" *ngIf="filteredBookings.length > 0; else noHistory">
  <h2>ğŸ§¾ Booking History for {{ email }}</h2>

  <div class="history-item" *ngFor="let booking of filteredBookings">
    <h3>{{ booking.train.trainName }} ({{ booking.train.sourceCode }} â†’ {{ booking.train.destinationCode }})</h3>
    <p><strong>Date:</strong> {{ booking.createdAt | date: 'medium' }}</p>
    <p><strong>Total Fare:</strong> â‚¹{{ booking.totalAmount }}</p>

    <ul>
      <li *ngFor="let p of booking.passengers">
        ğŸ‘¤ {{ p.name }} (Age {{ p.age }}) â€” {{ p.seatType }} â€”
        <span class="status-badge"
              [ngClass]="{
                'confirmed': p.status === 'Confirmed',
                'rac': p.status === 'RAC',
                'waiting': p.status === 'Waiting'
              }">
          {{ p.status }}
        </span>
        â€” â‚¹{{ p.fare }}
      </li>
    </ul>

    <div class="actions" style="justify-content: flex-end;">
      <button (click)="deleteBooking(booking.id)">ğŸ—‘ï¸ Delete</button>
    </div>
  </div>
</div>

<!-- ğŸš« No History -->
<ng-template #noHistory>
  <div class="ticket-container" style="text-align: center; padding: 20px;">
    <h2>ğŸ“­ No Bookings Yet</h2>
    <p>You haven't made any bookings yet. Start by searching for trains.</p>
    <div class="actions" style="margin-top: 20px;">
      <button routerLink="/train-search">ğŸ” Book Now</button>
    </div>
  </div>
</ng-template>
